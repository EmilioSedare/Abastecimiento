import math
import numpy as np
ks=0.0015/1000   # m
D = 290.8/1000# m
Q =120/1000# m3/s
L=200 #m
#-------------------------------------------------------------------------
#Hallando Viscosidad:
T=20     #Â°C
vis=(1.14-0.031*(T-15)+0.00068*((T-15)**2))*10**(-6)
#-------------------------------------------------------------------------
pi = math.pi
g = 9.807  # m/s2
# ==========================
A = (pi * (D ** 2)) / 4
v = Q / A
Re = (v * D) / vis
# ==========================
# Iteradores
error = 1
Tol = 0.0000001
x_0 = 0.1
# ==========================
if Re <= 2200:
    f_lami = 64 / Re
    print("--> fr = ", f_lami)
else:
    while error >= Tol:
        f = -2 * np.log10(ks / (3.7 * D) + 2.51 * x_0 / Re) - x_0
        df = -2 / (np.log(10)) * ((2.51 / Re) / (ks / (3.7 * D) + 2.51 * x_0 / Re)) - 1
        x_i = x_0 - (f / df)
        error = abs(x_i - x_0)  # 0.00000001   Tol=0.000001
        fr = 1 / (x_i ** 2)
        x_0 = x_i
        print("--> f= ", fr, "    ","--> Re= ", Re)
print("------------------------------------------")
print("--> f[final] : ", fr)
print("--> hf : ", fr*L/D*(v**2)/(2*g))
print("--> v : ", v)
print("------------------------------------------")